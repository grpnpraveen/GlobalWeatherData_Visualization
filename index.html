<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src = "https://cdn.jsdelivr.net/npm/d3@7"></script>
    <title>Document</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <nav class="nav-max" >
        <header>
          <img src="./icon.png" style="width: 50px;border-radius: 8px;" alt="">
          <h1>Global Weather</h1><span>2023</span>
        </header>
        <button id="toggle-nav-btn" class="circle"></button>
        <br>
        <hr>
        <ul class="menu">
          <li>
            <a class="nav-link" href="#">
                <img src="./cat.png" style="width: 45px;border-radius: 8px;" alt="">
                <span>
                    Categorical 
                </span>
            </a>
            <div onclick="show_cat(1)" id="cat1" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#7da6ff;">
              <input type="radio" id="condition_text" name="color" value="Number 3" checked>
              <label>Condition</label>
            </div>
            <div onclick="show_cat(2)" id="cat2" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
              <input type="radio" id="wind_direction" name="color" value="Number 3">
              <label>Wind Direction</label>
            </div>
            <div onclick="show_cat(3)" id="cat3" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
              <input type="radio" id="moon_phase" name="color" value="Number 3">
              <label >Moon Phase</label>
            </div>
            </div>
          </li>
          <li>
            <a class="nav-link" href="#">
                <img src="./hist.png" style="width: 45px;border-radius: 8px;" alt="">
              <span>Numerical</span>
            </a>  
            <div id="menu" style="overflow:scroll;height: 150px;">
              <div onclick="show_cat(4)" id="cat4" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="temperature_celsius" name="color" value="Number 3">
                <label>Temperature</label>
              </div>
              <div onclick="show_cat(5)" id="cat5" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="feels_like_celsius" name="color" value="Number 3">
                <label>Feels like</label>
              </div>
              <div onclick="show_cat(6)" id="cat6" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="humidity" name="color" value="Number 3">
                <label>Humidity</label>
              </div>
              <div onclick="show_cat(7)" id="cat7" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="uv_index" name="color" value="Number 3">
                <label>UV index</label>
              </div>
              <div onclick="show_cat(8)" id="cat8" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="wind_kph" name="color" value="Number 3">
                <label>Wind Speed</label>
              </div>
              <div onclick="show_cat(9)" id="cat9" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="gust_kph" name="color" value="Number 3">
                <label>Gust Speed</label>
              </div>
              <div onclick="show_cat(10)" id="cat10" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="pressure_in" name="color" value="Number 3">
                <label>Pressure</label>
              </div>
              <div onclick="show_cat(11)" id="cat11" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="visibility_km" name="color" value="Number 3">
                <label>visibility</label>
              </div>
              <div onclick="show_cat(12)" id="cat12" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="air_quality_Ozone" name="color" value="Number 3">
                <label>O3</label>
              </div>
              <div onclick="show_cat(13)" id="cat13" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="air_quality_Carbon_Monoxide" name="color" value="Number 3">
                <label>CO</label>
              </div>
              <div onclick="show_cat(14)" id="cat14" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="air_quality_Nitrogen_dioxide" name="color" value="Number 3">
                <label>NO2</label>
              </div>
              <div onclick="show_cat(15)" id="cat15" style="border-radius:8px;margin-top:5px;;margin-left: 60px;padding-left:30px;height: 25px;background:#36393f;">
                <input type="radio" id="air_quality_Sulphur_dioxide" name="color" value="Number 3">
                <label>SO2</label>
              </div>
         
            </div>
          </li>
          <li>
            <li>
                <a class="nav-link" href="#">
                    <img src="./direc.png" style="width: 45px;border-radius: 8px;" alt="">
                  <span>Direction</span>
                  <div class="check-box">
                    <input id="direction" type="checkbox">
                </div>
                </a>  
               
            </li>
        </ul>
      </nav>



    <!-- Data visualization -->
    <div class="main" style="margin-left: 180px;padding-top:30px;padding-left:200px;">

      <div id="visualization"></div>

    </div>


</body>
<script src = "scatterplot.js"></script>
<script src = "index.js"></script>
<script src = "bargraph.js"></script>
<script src = "bargraph_hor.js"></script>
<script src = "histogram.js"></script>
<script src = "histogram_hor.js"></script>
<script>
const navBar = document.querySelector("nav")
const toggleNavBtn = document.querySelector("#toggle-nav-btn")
const menu= document.getElementById("menu")
toggleNavBtn.addEventListener("click", (event) => {
  toggleNav()
})

function toggleNav() {
  if (navBar.classList.contains("nav-min")){
    openNav()
  } else {
    closeNav()
  }
}

function openNav() {
  navBar.classList.remove("nav-min") 
  navBar.classList.add("nav-max") 
}

function closeNav() {
  navBar.classList.remove("nav-max") 
  navBar.classList.add("nav-min")
}


// Medias
const phone = window.matchMedia("(width <= 480px)")
function media(e) {
  if (e.matches) {
    closeNav()
  } else {
    openNav()
  }
}
phone.addListener(media)


// DATA Visualization
var data;
var graph_heigth=100;
var direction_toogle = document.getElementById("direction");
var current_active=1;


direction_toogle.addEventListener('change', function() {

  show_cat(current_active);
});
// Load the CSV file  
d3.csv("data.csv").then(function(csvData) {
    // Save the data globally
    data = csvData;
    //console.log(data);
    //Create initial visualization upon page load
    //createVisualization("condition_text");
    //createVisualization("wind_direction");
    //createVisualization("moon_phase");

    //createVisualization("temperature_celsius");
    //createVisualization("humidity");
    //createVisualization("uv_index");
    //createVisualization("wind_kph");
    //createVisualization("pressure_in");
    //createVisualization("visibility_km");
    //createVisualization("air_quality_Carbon_Monoxide");
    //createVisualization("visibility_km");
    //createVisualization("air_quality_Carbon_Monoxide");
    //createVisualization("air_quality_Ozone");
    //createVisualization("air_quality_Nitrogen_dioxide");
    //createVisualization("air_quality_Sulphur_dioxide");
    //createVisualization("gust_kph");
    //createVisualization("feels_like_celsius");

    //createScatterPlot("condition_text","condition_text");
    createScatterPlot("temperature_celsius","uv_index");
}).catch(function(error) {
    // Handle any errors that occur during loading
    console.error("Error loading the CSV file:", error);
});

var data_info = {
  "condition_text": {"type": "categorical", "heading":"Weather Condition","x_title":"Condition","y_title":"Frequency"},
  "wind_direction": {"type": "categorical", "heading":"Wind direction","x_title":"Directions","y_title":"Frequency"},
  "moon_phase": {"type": "categorical", "heading":"Moon phases","x_title":"Phase","y_title":"Frequency"},

  "temperature_celsius": {"type": "numerical", "heading":"Global Temperature","x_title":"Temperature (c)","y_title":"Frequency"},
  "humidity": {"type": "numerical", "heading":"Global Humidity","x_title":"Humidity","y_title":"Frequency"},
  "uv_index": {"type": "numerical", "heading":"Global UV","x_title":"UV index","y_title":"Frequency"},
  "wind_kph": {"type": "numerical", "heading":"Global Wind Speed","x_title":"Wind Speed (kph)","y_title":"Frequency"},
  "pressure_in": {"type": "numerical", "heading":"Global Pressure","x_title":"Pressure (in)","y_title":"Frequency"},
  "visibility_km": {"type": "numerical", "heading":"Global Visibility","x_title":"Visibility (km)","y_title":"Frequency"},
  "air_quality_Carbon_Monoxide": {"type": "numerical", "heading":"Air Quality (CO)","x_title":"Carbon Monoxide (%)","y_title":"Frequency"},
  "air_quality_Ozone": {"type": "numerical", "heading":"Air Quality (O3)","x_title":"Ozone (%)","y_title":"Frequency"},
  "air_quality_Nitrogen_dioxide": {"type": "numerical", "heading":"Air Quality (NO2)","x_title":"Nitrogen Dioxide (%)","y_title":"Frequency"},
  "air_quality_Sulphur_dioxide": {"type": "numerical", "heading":"Air Quality (SO2)","x_title":"Sulphur Dioxide (%)","y_title":"Frequency"},
  "gust_kph": {"type": "numerical", "heading":"Speed of Gust","x_title":"speed (kph)","y_title":"Frequency"},
  "feels_like_celsius": {"type": "numerical", "heading":"Feels like Temperature","x_title":"Temperature (c)","y_title":"Frequency"},
};


var get_unique = (data,attribute) => {
  let unique_values = [
      ...new Set(data.map((element) => element[attribute])),
  ];
  return unique_values;
};

function get_graph_data(attribute)
{
  if(attribute=="country" || attribute=="condition_text" || attribute=="wind_direction" ||  attribute=="moon_phase" || attribute=="location_name")
  {
    var graph_data =[];
    var unique_countries = get_unique(data,attribute);

    console.log(unique_countries);
    for (let i = 0; i < unique_countries.length; i++) {
      var temp ={};
      temp[unique_countries[i]]=0;

      for (let j = 0; j < data.length; j++) {
        if( data[j][attribute]==unique_countries[i])
        {
          temp[unique_countries[i]]=temp[unique_countries[i]]+1;
        }
      }
      graph_data.push({"x_values":unique_countries[i],"y_values":temp[unique_countries[i]]});
    }
    return graph_data;
  }
}

// Function to create visualization based on user's selection
function createVisualization(selectedAttribute) {
    console.log(data_info[selectedAttribute]["type"])
    var selectedDataType = data_info[selectedAttribute]["type"];
    var selectedAttribute = selectedAttribute; 

    if (selectedDataType === "numerical") {
        createHistogram(selectedAttribute);
    }else if (selectedDataType === "categorical") {
        createBarGraph(selectedAttribute);
    }
}


</script>

</html>